<div class="container-fluid">
  <!-- Titulo principal -->
  <div class="row p-2 justify-content-center align-items-center">
    <div class="col text-center">
      <h2 class="p-0 m-0">Profesiones disponibles</h2>
    </div>
  </div>

  <!-- Buscar y agregar profesion -->
  <div class="row p-2 justify-content-center align-items-center">
    <div class="col-xl-7 col-lg-5"></div>
    <div class="col-xl-3 col-lg-4">
      <div class="input-group">
        <input type="text" class="form-control" placeholder="Buscar" aria-label="Buscar" aria-describedby="basic-addon1" (input)="search($event)">
        <button class="input-group-text" id="basic-addon1"> <i class="bi bi-search"></i> </button>
      </div>
    </div>
    <div class="col-xl-2 col-lg-3">
      <button type="button" class="btn btn-primary">Agregar profesión</button>
    </div>
  </div>

  <!-- Contenedor de profesiones -->
  <div class="row justify-content-center align-items-center p-0">
    <div class="col-10 text-center">
      <!-- Titulo -->
      <div class="row p-2 bg-primary text-white">
        <div class="col-3 align-self-center">
          <h3 class="p-0 m-0">Foto</h3>
        </div>

        <div class="col-3 align-self-center">
          <h3 class="p-0 m-0">Nombre</h3>
        </div>

        <div class="col-3 align-self-center">
          <h3 class="p-0 m-0">Servicio</h3>
        </div>

        <div class="col-3 align-self-center">
          <h3 class="p-0 m-0">Estado</h3>
        </div>
      </div>

      <!-- Profesion -->
      <div (click)="profesion_seleccionada=profesion" *ngFor="let profesion of arr_filtered_profesiones" class="row p-2 bg-light fila_info_profesion" data-bs-toggle="modal" href="#modalInformacionProfesion" role="button">
        <div class="col-3 align-self-center">
          <img [src]="'https://tomesoft1.pythonanywhere.com'+profesion.foto" class="rounded mx-auto d-block img-fluid img_profesion" alt="...">
        </div>

        <div class="col-3 align-self-center">
          <h4 class="p-0 m-0"> {{profesion.nombre}} </h4>
        </div>

        <div class="col-3 align-self-center">
          <h4 class="p-0 m-0">{{profesion.servicio[0].nombre}}</h4>
        </div>

        <div class="col-3 align-self-center">
          <h4 class="p-0 m-0">{{profesion.estado}}</h4>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal informacion de profesion -->
<div class="modal fade" id="modalInformacionProfesion" aria-hidden="true" aria-labelledby="modalInformacionProfesionLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header align-items-center">
        <h1 class="modal-title fs-5 m-0 p-0 fw-bold" id="modalInformacionProfesionLabel">Información de profesión</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body mb-0">
        <div class="row p-2">
          <img [src]="profesion_seleccionada?'https://tomesoft1.pythonanywhere.com'+profesion_seleccionada.foto:''" class="rounded mx-auto d-block img-fluid w-50" alt="...">
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <h3 class="m-0 p-0 fw-bold">Nombre:</h3>
          </div>
          <div class="col-7">
            {{profesion_seleccionada?.nombre}}
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <h3 class="m-0 p-0 fw-bold">Descripción:</h3>
          </div>
          <div class="col-7">
            {{profesion_seleccionada?.descripcion}}
          </div>
        </div>

        <div class="row p-2 align-items-center">
          <div class="col-5">
            <h3 class="m-0 p-0 fw-bold">Servicio asignado:</h3>
          </div>
          <div class="col-7">
            {{profesion_seleccionada?.nombre}}
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" data-bs-target="#modalInformacionEdicionProfesion" data-bs-toggle="modal">Editar</button>
        <button class="btn btn-danger" data-bs-target="#modalInformacionEdicionProfesion" data-bs-toggle="modal">Eliminar</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal edicion de informacion de profesion -->
<div class="modal fade" id="modalInformacionEdicionProfesion" aria-hidden="true" aria-labelledby="modalInformacionEdicionProfesionLabel" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header align-items-center">
        <h1 class="modal-title fs-5 m-0 p-0 fw-bold" id="modalInformacionEdicionProfesionLabel">Edición de profesión</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body mb-0">
        <form [formGroup]="crearProfesionesForm" class="">
          <div class="row">
            <div class="col d-flex justify-content-center">
              <img class="rounded mx-auto d-block img-fluid w-50" [src]="imagen? imagen : profesion_seleccionada?'https://tomesoft1.pythonanywhere.com'+profesion_seleccionada.foto:''">
            </div>
            <div class="p-2">
              <input
                class="w-100 centrar form-control"
                [ngClass]="crearProfesionesForm.get('imagen')?.hasError('image_error') ? 'is-invalid' : '' || (existImage)? 'is-valid' : ''"
                type="file"
                id="file_input"
                accept="image/png, image/jpeg"
                (change)="loadImageFromDevice($event)"
              >
              <div class="invalid-feedback">{{getErrorMessage(crearProfesionesForm, 'imagen')}}</div>
            </div>
          </div>

          <div class="row p-2 align-items-center">
            <div class="col-5">
              <label for="inputNombre" class="form-label"><h3 class="m-0 p-0 fw-bold">Nombre:</h3></label>
            </div>
            <div class="col-7">
              <input
                type="text"
                formControlName="nombre"
                class="form-control"
                [ngClass]="isInvalidForm('nombre') ? 'is-invalid' : ''"
                id="inputNombre"
                value="Mark"
                [placeholder]="profesion_seleccionada?.nombre"
              >
              <div class="invalid-feedback"> {{getErrorMessage(crearProfesionesForm, 'nombre')}} </div>
            </div>
          </div>

          <div class="row p-2 align-items-center">
            <div class="col-5">
              <label for="textareaDescripcion" class="form-label"><h3 class="m-0 p-0 fw-bold">Descripción:</h3></label>
            </div>
            <div class="col-7">
              <textarea
                class="form-control"
                formControlName="descripcion"
                [ngClass]="isInvalidForm('descripcion') ? 'is-invalid' : ''"
                id="textareaDescripcion"
                [placeholder]="profesion_seleccionada?.descripcion"
              ></textarea>
            <div class="invalid-feedback"> {{getErrorMessage(crearProfesionesForm, 'descripcion')}} </div>
            </div>
          </div>

          <div class="row p-2 align-items-center">
            <div class="col-5">
              <label for="selectorServicio" class="form-label"><h3 class="m-0 p-0 fw-bold">Servicio asignado:</h3></label>
            </div>
            <div class="col-7">
              <select
                class="form-select"
                [ngClass]="isInvalidForm('servicio') ? 'is-invalid' : ''"
                formControlName="servicio"
                id="selectorServicio"
                aria-describedby="selectorServicioFeedback"
              >
                <option selected disabled value="">Elija un servicio...</option>
                <option *ngFor="let servicio of arr_servicios" [id]="servicio.id" [value]="servicio.nombre"> {{servicio.nombre}} </option>
              </select>
              <div id="selectorServicioFeedback" class="invalid-feedback"> {{getErrorMessage(crearProfesionesForm, 'servicio')}} </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" data-bs-target="#modalInformacionProfesion" data-bs-toggle="modal">Regresar</button>
        <button
          [disabled]="crearProfesionesForm.invalid? true : false"
          data-bs-target="#modalConfirmacion"
          data-bs-toggle="modal"
          class="btn btn-warning"
          (click)="establecerMensaje('Está seguro que desea actualizar la información?', 'actualizar')"
        >Actualizar</button>
      </div>

      <!-- <pre>
        {{crearProfesionesForm.value | json}}
      </pre> -->
    </div>
  </div>
</div>

<!-- Modal de confirmacion (Alerta) -->
<div class="modal fade" id="modalConfirmacion" tabindex="-1" aria-labelledby="modalConfirmacionLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="modalConfirmacionLabel">Confirmar selección</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {{mensajeAlerta}}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        <button *ngIf="isCrear" type="button" class="btn btn-success" (click)="onCrear()" data-bs-dismiss="modal">Confirmar</button>
        <button *ngIf="isActualizar" type="button" class="btn btn-success" (click)="onActualizar()" data-bs-dismiss="modal">Confirmar</button>
        <button *ngIf="isEliminar" type="button" class="btn btn-success" (click)="onDelete()" data-bs-dismiss="modal">Confirmar</button>
      </div>
    </div>
  </div>
</div>
